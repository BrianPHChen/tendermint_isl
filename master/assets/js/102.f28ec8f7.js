(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{799:function(e,t,a){"use strict";a.r(t);var n=a(1),r=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"adr-034-privvalidator-file-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adr-034-privvalidator-file-structure"}},[e._v("#")]),e._v(" ADR 034: PrivValidator file structure")]),e._v(" "),a("h2",{attrs:{id:"changelog"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#changelog"}},[e._v("#")]),e._v(" Changelog")]),e._v(" "),a("p",[e._v("03-11-2018: Initial Draft")]),e._v(" "),a("h2",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[e._v("#")]),e._v(" Context")]),e._v(" "),a("p",[e._v("For now, the PrivValidator file "),a("code",[e._v("priv_validator.json")]),e._v(" contains mutable and immutable parts.\nEven in an insecure mode which does not encrypt private key on disk, it is reasonable to separate\nthe mutable part and immutable part.")]),e._v(" "),a("p",[e._v("References:\n"),a("a",{attrs:{href:"https://github.com/tendermint/tendermint/issues/1181",target:"_blank",rel:"noopener noreferrer"}},[e._v("#1181"),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://github.com/tendermint/tendermint/issues/2657",target:"_blank",rel:"noopener noreferrer"}},[e._v("#2657"),a("OutboundLink")],1),e._v(" "),a("a",{attrs:{href:"https://github.com/tendermint/tendermint/issues/2313",target:"_blank",rel:"noopener noreferrer"}},[e._v("#2313"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"proposed-solution"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proposed-solution"}},[e._v("#")]),e._v(" Proposed Solution")]),e._v(" "),a("p",[e._v("We can split mutable and immutable parts with two structs:")]),e._v(" "),a("code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gRmlsZVBWS2V5IHN0b3JlcyB0aGUgaW1tdXRhYmxlIHBhcnQgb2YgUHJpdlZhbGlkYXRvcgp0eXBlIEZpbGVQVktleSBzdHJ1Y3QgewoJQWRkcmVzcyB0eXBlcy5BZGRyZXNzICBganNvbjomcXVvdDthZGRyZXNzJnF1b3Q7YAoJUHViS2V5ICBjcnlwdG8uUHViS2V5ICBganNvbjomcXVvdDtwdWJfa2V5JnF1b3Q7YAoJUHJpdktleSBjcnlwdG8uUHJpdktleSBganNvbjomcXVvdDtwcml2X2tleSZxdW90O2AKCglmaWxlUGF0aCBzdHJpbmcKfQoKLy8gRmlsZVBWU3RhdGUgc3RvcmVzIHRoZSBtdXRhYmxlIHBhcnQgb2YgUHJpdlZhbGlkYXRvcgp0eXBlIEZpbGVQVkxhc3RTaWduU3RhdGUgc3RydWN0IHsKCUhlaWdodCAgICBpbnQ2NCAgICAgICAgYGpzb246JnF1b3Q7aGVpZ2h0JnF1b3Q7YAoJUm91bmQgICAgIGludCAgICAgICAgICBganNvbjomcXVvdDtyb3VuZCZxdW90O2AKCVN0ZXAgICAgICBpbnQ4ICAgICAgICAgYGpzb246JnF1b3Q7c3RlcCZxdW90O2AKCVNpZ25hdHVyZSBbXWJ5dGUgICAgICAgYGpzb246JnF1b3Q7c2lnbmF0dXJlLG9taXRlbXB0eSZxdW90O2AKCVNpZ25CeXRlcyBjbW4uSGV4Qnl0ZXMgYGpzb246JnF1b3Q7c2lnbmJ5dGVzLG9taXRlbXB0eSZxdW90O2AKCglmaWxlUGF0aCBzdHJpbmcKCW10eCAgICAgIHN5bmMuTXV0ZXgKfQo="}}),e._v(" "),a("p",[e._v("Then we can combine "),a("code",[e._v("FilePVKey")]),e._v(" with "),a("code",[e._v("FilePVLastSignState")]),e._v(" and will get the original "),a("code",[e._v("FilePV")]),e._v(".")]),e._v(" "),a("code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dHlwZSBGaWxlUFYgc3RydWN0IHsKCUtleSAgICAgICAgICAgRmlsZVBWS2V5CglMYXN0U2lnblN0YXRlIEZpbGVQVkxhc3RTaWduU3RhdGUKfQo="}}),e._v(" "),a("p",[e._v("As discussed, "),a("code",[e._v("FilePV")]),e._v(" should be located in "),a("code",[e._v("config")]),e._v(", and "),a("code",[e._v("FilePVLastSignState")]),e._v(" should be stored in "),a("code",[e._v("data")]),e._v(". The\nstore path of each file should be specified in "),a("code",[e._v("config.yml")]),e._v(".")]),e._v(" "),a("p",[e._v("What we need to do next is changing the methods of "),a("code",[e._v("FilePV")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"status"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#status"}},[e._v("#")]),e._v(" Status")]),e._v(" "),a("p",[e._v("Accepted and implemented in "),a("a",{attrs:{href:"https://github.com/tendermint/tendermint/pull/2870",target:"_blank",rel:"noopener noreferrer"}},[e._v("#2870"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"consequences"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#consequences"}},[e._v("#")]),e._v(" Consequences")]),e._v(" "),a("h3",{attrs:{id:"positive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#positive"}},[e._v("#")]),e._v(" Positive")]),e._v(" "),a("ul",[a("li",[e._v("separate the mutable and immutable of PrivValidator")])]),e._v(" "),a("h3",{attrs:{id:"negative"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#negative"}},[e._v("#")]),e._v(" Negative")]),e._v(" "),a("ul",[a("li",[e._v("need to add more config for file path")])]),e._v(" "),a("h3",{attrs:{id:"neutral"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#neutral"}},[e._v("#")]),e._v(" Neutral")])],1)}),[],!1,null,null,null);t.default=r.exports}}]);